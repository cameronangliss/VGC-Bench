import numpy as np
import matplotlib.pyplot as plt

# Data definitions
algos = ["R", "MBP", "SH", "LLM", "SP", "FP", "DO", "BC", "BCSP", "BCFP", "BCDO"]

data_list = [
    100 * np.array(
        [
            [np.nan, 0.06, 0.01, 0.38, 0.01, 0.02, 0.04, 0.05, 0.0, 0.01, 0.04],
            [0.94, np.nan, 0.4, 0.88, 0.29, 0.48, 0.33, 0.53, 0.22, 0.06, 0.27],
            [0.99, 0.6, np.nan, 0.91, 0.52, 0.4, 1.0, 0.65, 0.25, 0.22, 0.62],
            [0.62, 0.12, 0.09, np.nan, 0.05, 0.02, 0.02, 0.12, 0.01, 0.0, 0.05],
            [0.99, 0.71, 0.48, 0.95, np.nan, 0.3, 0.95, 0.73, 0.2, 0.61, 0.62],
            [0.98, 0.52, 0.6, 0.98, 0.7, np.nan, 0.38, 0.88, 0.63, 0.83, 0.78],
            [0.96, 0.67, 0.0, 0.98, 0.05, 0.62, np.nan, 0.83, 0.4, 0.17, 0.08],
            [0.95, 0.47, 0.35, 0.88, 0.27, 0.12, 0.17, np.nan, 0.13, 0.04, 0.18],
            [1.0, 0.78, 0.75, 0.99, 0.8, 0.37, 0.6, 0.87, np.nan, 0.38, 0.55],
            [0.99, 0.94, 0.78, 1.0, 0.39, 0.17, 0.83, 0.96, 0.62, np.nan, 0.89],
            [0.96, 0.73, 0.38, 0.95, 0.38, 0.22, 0.92, 0.82, 0.45, 0.11, np.nan]
        ]
    ),
    100 * np.array(
        [
            [np.nan, 0.09, 0.01, 0.48, 0.03, 0.02, 0.04, 0.16, 0.0, 0.02, 0.0],
            [0.91, np.nan, 0.38, 0.85, 0.25, 0.21, 0.35, 0.66, 0.08, 0.12, 0.1],
            [0.99, 0.62, np.nan, 0.97, 0.35, 0.45, 0.53, 0.79, 0.34, 0.32, 0.21],
            [0.52, 0.15, 0.03, np.nan, 0.04, 0.02, 0.07, 0.16, 0.03, 0.02, 0.0],
            [0.97, 0.75, 0.65, 0.96, np.nan, 0.53, 0.69, 0.9, 0.38, 0.46, 0.35],
            [0.98, 0.79, 0.55, 0.98, 0.47, np.nan, 0.53, 0.87, 0.17, 0.38, 0.33],
            [0.96, 0.65, 0.47, 0.93, 0.31, 0.47, np.nan, 0.74, 0.14, 0.18, 0.14],
            [0.84, 0.34, 0.21, 0.84, 0.1, 0.13, 0.26, np.nan, 0.05, 0.07, 0.1],
            [1.0, 0.92, 0.66, 0.97, 0.62, 0.83, 0.86, 0.95, np.nan, 0.63, 0.59],
            [0.98, 0.88, 0.68, 0.98, 0.54, 0.62, 0.82, 0.93, 0.37, np.nan, 0.58],
            [1.0, 0.9, 0.79, 1.0, 0.65, 0.67, 0.86, 0.9, 0.41, 0.42, np.nan]
        ]
    ),
    100 * np.array(
        [
            [np.nan, 0.1, 0.01, 0.41, 0.01, 0.02, 0.05, 0.13, 0.03, 0.01, 0.0],
            [0.9, np.nan, 0.23, 0.93, 0.28, 0.28, 0.32, 0.59, 0.18, 0.11, 0.07],
            [0.99, 0.77, np.nan, 0.91, 0.48, 0.61, 0.48, 0.73, 0.33, 0.24, 0.25],
            [0.59, 0.07, 0.09, np.nan, 0.01, 0.07, 0.03, 0.14, 0.01, 0.02, 0.02],
            [0.99, 0.72, 0.52, 0.99, np.nan, 0.48, 0.67, 0.68, 0.35, 0.28, 0.28],
            [0.98, 0.72, 0.39, 0.93, 0.52, np.nan, 0.64, 0.84, 0.37, 0.29, 0.21],
            [0.95, 0.68, 0.52, 0.97, 0.33, 0.36, np.nan, 0.63, 0.35, 0.19, 0.2],
            [0.87, 0.41, 0.27, 0.86, 0.32, 0.16, 0.37, np.nan, 0.1, 0.12, 0.13],
            [0.97, 0.82, 0.67, 0.99, 0.65, 0.63, 0.65, 0.9, np.nan, 0.51, 0.4],
            [0.99, 0.89, 0.76, 0.98, 0.72, 0.71, 0.81, 0.88, 0.49, np.nan, 0.52],
            [1.0, 0.93, 0.75, 0.98, 0.72, 0.79, 0.8, 0.87, 0.6, 0.48, np.nan]
        ]
    ),
    100 * np.array(
        [
            [np.nan, 0.11, 0.02, 0.45, 0.05, 0.06, 0.04, 0.11, 0.04, 0.02, 0.02],
            [0.89, np.nan, 0.19, 0.92, 0.36, 0.28, 0.31, 0.6, 0.21, 0.13, 0.22],
            [0.98, 0.81, np.nan, 0.94, 0.49, 0.57, 0.42, 0.8, 0.33, 0.38, 0.26],
            [0.55, 0.08, 0.06, np.nan, 0.07, 0.01, 0.06, 0.16, 0.05, 0.03, 0.02],
            [0.95, 0.64, 0.51, 0.93, np.nan, 0.45, 0.54, 0.73, 0.33, 0.31, 0.27],
            [0.94, 0.72, 0.43, 0.99, 0.55, np.nan, 0.44, 0.67, 0.32, 0.33, 0.39],
            [0.96, 0.69, 0.58, 0.94, 0.46, 0.56, np.nan, 0.66, 0.28, 0.26, 0.31],
            [0.89, 0.4, 0.2, 0.84, 0.27, 0.33, 0.34, np.nan, 0.15, 0.1, 0.17],
            [0.96, 0.79, 0.67, 0.95, 0.67, 0.68, 0.72, 0.85, np.nan, 0.48, 0.45],
            [0.98, 0.87, 0.62, 0.97, 0.69, 0.67, 0.74, 0.9, 0.52, np.nan, 0.49],
            [0.98, 0.78, 0.74, 0.98, 0.73, 0.61, 0.69, 0.83, 0.55, 0.51, np.nan]
        ]
    ),
]
titles = ["1 team", "3 teams", "10 teams", "30 teams"]

# Plotting with minimal spacing and centered tick labels
fig, axes = plt.subplots(
    1, 4, figsize=(12, 13), gridspec_kw={"left": 0.05, "right": 0.88, "hspace": 0.2, "wspace": 0.3}
)
vmin, vmax = 0, 100
im = None
for ax, data, title in zip(axes.flat, data_list, titles):
    masked = np.ma.masked_invalid(data)
    im = ax.imshow(masked, vmin=vmin, vmax=vmax)
    ax.set_title(title)
    ax.set_xticks(range(len(algos)))
    ax.set_xticklabels(algos, rotation=45, ha="center", rotation_mode="anchor")
    ax.tick_params(axis="x", pad=10)
    ax.set_yticks(range(len(algos)))
    ax.set_yticklabels(algos)
    ax.grid(False)

# Add a colorbar on the right side
cbar_ax = fig.add_axes((0.9, 0.4, 0.02, 0.18))
assert im is not None
fig.colorbar(im, cax=cbar_ax, label="Win Count")

plt.savefig("heatmaps.png")
